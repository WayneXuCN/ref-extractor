<!doctype html>
<html lang="en">

<head>
  <title>Reference Extractor</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="css/sticky-footer-navbar.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.3.0/jszip.min.js" integrity="sha256-J0jjrR5bYbE+saHyVcuvt2EIg5JAHN10VWyTHtVJV2E=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/citation-js@0.4.0-10"></script>

  <style>
    .btn {
      white-space: nowrap;
    }
    
    .dropdown-menu {
      font-size: small;
      white-space: nowrap;
      padding-left: 10px;
      padding-right: 10px;
    }
  </style>
</head>

<body class="d-flex flex-column h-100">
  <header>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-expand-md navbar-dark" style="background-color: #6c757d;">
      <div class="container">
        <span class="navbar-brand mb-0 h1">Reference Extractor</span>
      </div>
    </nav>
  </header>

  <!-- Begin page content -->
  <main role="main" class="flex-shrink-0">
    <div class="container">
      <div class="row my-3">
        <div class="col-lg-8">
          <p><strong>Reference Extractor</strong> is an online tool to extract <a href="https://www.zotero.org/">Zotero</a> and <a href="https://www.mendeley.com/">Mendeley</a> references from Microsoft Word and LibreOffice documents.
            See the bottom of this page for instructions.</p>
          <hr>
          <br>
          <div class="container">
            <div class="col-lg-11 text-center">
              <h5>Step 1.</h5>
              <p>Select your Word (.docx) or LibreOffice (.odt) file</p>
              <form autocomplete="off">
                <div class="form-group">
                  <input id="file_upload" type="file">
                </div>
              </form>
            </div>
          </div>
          <br>
          <div class="container">
            <div class="col-lg-11">
              <h5 class="text-center">Step 2.</h5>
              <p class="text-center">Save the extracted citations in your preferred format, or select them in your Zotero library.</p>
              <div class="container">
                <div class="offset-lg-1">
                  <form autocomplete="off">
                    <div class="form-group row" style="margin-bottom:0px;">
                      <div class="col-lg-4">
                        <label for="extract_count" class="col-form-label col-form-label-sm">Number of extracted references</label>
                      </div>
                      <div class="col-lg-8">
                        <input type="text" readonly class="form-control-plaintext form-control-sm" id="extract_count" value="0">
                      </div>
                    </div>
                    <div class="form-group row" style="margin-bottom:0px;">
                      <div class="col-lg-4">
                        <label for="selected_style" class="col-form-label col-form-label-sm">CSL style selected in document</label>
                      </div>
                      <div class="col-lg-8">
                        <input type="text" readonly class="form-control-plaintext form-control-sm" id="selected_style" value="-">
                      </div>
                    </div>
                    <div class="form-group row" style="margin-bottom:4px;">
                      <div class="col-lg-4">
                        <label for="output_format" class="control-label col-form-label-sm">Output format</label>
                      </div>
                      <div class="col-lg-8">
                        <select id="output_format" class="form-select form-select-sm">
                          <option value="data" selected>CSL JSON</option>
                          <option value="data-with-counts">CSL JSON (with cite counts)</option>
                          <option value="bibtex">BibTeX</option>
                          <option value="ris">RIS</option>
                          <option value="bibliography">APA references</option>
                          <option value="bibliography-with-counts">APA references (with cite counts, tab-separated)</option>
                        </select>
                      </div>
                    </div>
                    <div class="form-group row">
                      <div class="col-lg-4">
                        <label for="textArea" class="control-label col-form-label-sm">Extracted references</label>
                      </div>
                      <div class="col-lg-8">
                        <button id="download" type="button" class="btn btn-success btn-sm" disabled>Download</button>
                        <button id="copy_to_clipboard" data-clipboard-text="" type="button" class="btn btn-success btn-sm" disabled>Copy to clipboard</button>
                        <div class="btn-group">
                          <button id="zotero_item_selection_button" type="button" class="btn btn-outline-success btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                            Select in Zotero <span class="caret"></span>
                          </button>
                          <ul class="dropdown-menu" id="zotero_item_selection_link_list"></ul>
                        </div>
                      </div>
                      <div class="col-lg-12" style="padding-left:0px;">
                        <textarea id="textArea" class="form-control form-control-sm" rows="3" readonly style="margin-top: 10px;"></textarea>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <hr>
          <h4>About Reference Extractor</h4>
          <p>Reference Extractor is free online tool that allows you to extract references from Word (.docx) and LibreOffice (.odt) documents that have been inserted with
             the Zotero or Mendeley word processor plugins.</p>
          <p>This can be handy if you lost access to your Zotero/Mendeley library but still have your documents. In this case, you can use Reference Extractor to recover
             the items you cited in your documents, and import them back into your reference manager. Or maybe you received a document from somebody else, and you would
             like to import the cited items into your own reference manager library.</p>
          <p>In addition, if you have document in which you cited items from your own Zotero library in a document, you can use
            Reference Extractor to select these cited items in your Zotero library. You can then e.g. add these items to a collection or apply a tag to them.</p>
          <h5>Limitations</h5>
          <p>To make sure Reference Manager is the right tool for you, let's go over its main limitations. It cannot:</p>
          <ul>
            <li>extract references from document formats other than .docx and .odt</li>
            <li>extract references that were inserted with other reference managers</li>
            <li>extract plain-text references</li>
          </ul>
          <p>If you aren't sure what reference manager was used to insert references, or if they are plain-text or not, you can just give Reference Manager a try and see if it finds any references.
            Alternatively, you can verify that the references in the document consist of <a href="https://www.zotero.org/support/kb/word_field_codes">active field codes</a>. Whereas plain-text
            citations look and behave like regular text, active field codes have grey shading by default, and can be toggled by pressing <kbd>Alt</kbd>+<kbd>F9</kbd> (PC) or <kbd>Option</kbd>+<kbd>F9</kbd> (Mac)
            in a Word document. When toggled, Zotero and Mendeley active field codes (and any other field codes) will expand and show their embedded metadata.
            Toggled Zotero fields start with "ADDIN ZOTERO_ITEM CSL_CITATION", and toggled Mendeley fields start with "ADDIN CSL_CITATION".</p>
          <p>In addition, if you import extracted references into Zotero or Mendeley, these programs won't recognize that these newly imported items match the items in your document.
            To establish these links, you need to manually replace each citation in your document with the matching imported item.
          </p>
          <p>If you aren't sure Reference Extractor is a good fit, make sure to review Zotero's listing of <a href="https://www.zotero.org/support/kb/importing_formatted_bibliographies">alternative tools</a>.</p>
          <h5>What about my privacy?</h5>
          <p>Reference Extractor is private and secure. The extraction is performed locally in your web browser and can be run offline. Your documents never leave your computer.
          <h5>Is it really free?</h5>
          <p>Yes! Reference Extractor is a labor of love.
            However, if the tool saved you time, please consider supporting me with a small <a href="https://ko-fi.com/rintzezelle">donation</a> and/or by starring (upvoting) the <a href="https://github.com/rmzelle/ref-extractor/">Reference Extractor GitHub repository</a>.</p>
          <p>Check the <a href="https://github.com/rmzelle/ref-extractor#reference-extractor">README</a> for more information about this tool and how to use it.</p>
          <h5>I'm ready! How do I use this tool?</h5>
          <h6>Extracting a document</h6>
          <p>Using Reference Manager is simple: start by clicking the "Choose File" button at the top of this page and select your Word or LibreOffice document.
            Reference Extractor will then automatically extract all Zotero and Mendeley references it can find.
            Items that have been cited multiple times are deduplicated, and Reference Extractor keeps track of how many times each item was cited.</p>
          <p>If Reference Extractor was successful in extracting references, it will show the number of references it was able to extract (after deduplication) and the number of duplicates removed.
            It will also show which <a href="https://citationstyles.org/">Citation Style Language</a> citation style was selected in the document.</p>
          <h6>Selecting an output format</h6>
          <p>You now have the option to choose between the following output formats:</p>
          <ul>
            <li>CSL JSON</li>
            <li>CSL JSON (with cite counts)</li>
            <li>BibTeX</li>
            <li>RIS</li>
            <li>APA references</li>
            <li>APA references (with cite counts, tab-separated)</li>
          </ul>
          <p>Extracted references are natively in the CSL JSON format, and this format is recommended if your reference manager can import it.
            Otherwise you can select the widely supported BibTeX or RIS format. You can also generate formatted references in APA format.</p>
          <p>Two formats include cite counts (the number of times each reference was cited in the document): "CSL JSON (with cite counts)",
            where the cite count is stored in the "note" field (named "Extra" in Zotero), and "APA references (with cite counts, tab-separated)",
            a two-column tab-separated-value format with the formatted reference in one column, and the cite count in the other.
          </p>
        </div>
        <div class="col-lg-3">
          <div class="card bg-light">
            <h5 class="card-header text-white bg-info">Support</h5>
            <div class="card-body">
              <p class="card-text">Did you find this free tool useful?</p>
              <p class="card-text">If so, please support this open-source project. Star my <a href="https://github.com/rmzelle/ref-extractor/">GitHub repository</a>, or make a small donation:</p>
              <div class="text-center" style="font-size: small;">
                <a href='https://ko-fi.com/rintzezelle' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://cdn.ko-fi.com/cdn/kofi4.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com'></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer mt-auto py-3">
    <div class="container">
      <span class="text-muted">Created by <a href="https://rintze.zelle.me/" target="_blank">Rintze M. Zelle</a> (<a href="https://genomic.social/@rintze_zelle" target="_blank"><img src="images/mastodon-logo-purple.svg" width="25" height="25" alt="Rintze Zelle's Mastodon profile"></a>).
        Powered by GitHub Pages. <a href="https://github.com/rmzelle/ref-extractor/">Code</a> on GitHub.</span>
    </div>
  </footer>
  <script src="libraries/ref-extractor.js"></script>
</body>

</html>
