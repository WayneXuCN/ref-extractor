<!DOCTYPE html>
<html lang="en">

<head>
  <title>Reference Extractor</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap-theme.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.0/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/citation-js@0.4.0-10"></script>
  <style>
    .adjust-top {
      padding-top: 7px;
    }
    
    .nav-tabs {
      margin-bottom: 15px;
    }

    .form-group.has-success {
      margin-bottom: 5px;
    }
  </style>
</head>

<body>
  <div class="container-fluid">
    <div class="navbar navbar-default" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <div class="navbar-brand">Reference Extractor</div>
          <div class="navbar-text">Extract Zotero and Mendeley references from Microsoft Word files</div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-offset-1 col-sm-7">
        <div>
          <!-- Nav tabs -->
          <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Home</a></li>
            <li role="presentation"><a href="#generalTips" aria-controls="generalTips" role="tab" data-toggle="tab">General tips</a></li>
            <li role="presentation"><a href="#zoteroTips" aria-controls="zoteroTips" role="tab" data-toggle="tab">Zotero tips</a></li>
            <li role="presentation"><a href="#troubleshooting" aria-controls="troubleshooting" role="tab" data-toggle="tab">Troubleshooting</a></li>
            <li role="presentation"><a href="#testimonials" aria-controls="testimonials" role="tab" data-toggle="tab">Testimonials</a></li>
          </ul>

          <!-- Tab panes -->
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="home">
              <strong>Reference Extractor</strong> is a free tool to extract <a href="https://www.zotero.org/">Zotero</a> and <a href="https://www.mendeley.com/">Mendeley</a> references from Microsoft Word <strong>.docx</strong> documents.
                With this tool, you can:
              <ul>
                <li>Extract references and save them in CSL JSON, BibTeX, or RIS format, or as a bibliography in APA style.
                  <ul>
                    <li>This feature can be useful if you e.g. lost your Zotero/Mendeley library but still have your Word documents.
                      Or perhaps somebody sent you a Word document and you would like to get the cited items into your own reference manager library.</li>
                  </ul>
                </li>
                <li>Select the original cited items in your existing Zotero libraries. [available for Zotero only]
                  <ul>
                    <li>Once items are selected in Zotero, you can drag the items into a new collection or apply a tag.</li>
                  </ul>
                </li>
                <li>Discover how many times each item has been cited.</li>
                <li>See which <a href="https://citationstyles.org/">Citation Style Language</a> citation style was used in the Word document.</li>
              </ul>
              I care about your privacy. Reference Extractor does all its work on your own computer, and your documents are never sent across the internet. No snooping, no tracking, no ads.
            </div>
            <div role="tabpanel" class="tab-pane" id="generalTips">
              <p>Few reference managers can import CSL JSON files, but it's the most accurate output format Reference Extractor can generate, as it is the same format used by Zotero and Mendeley to embed item metadata in Word documents.
                All other output formats involve a format conversion.
                If you discover issues with the RIS or BibTeX output formats, you can try importing the CSL JSON files into Zotero and use Zotero to convert the reference to the desired output format.
              </p>
            </div>
            <div role="tabpanel" class="tab-pane" id="zoteroTips">
              <ul>
                <li>Zotero references are only detected if they have been stored as "Fields", not "Bookmarks".
                  This can be changed for existing documents through the <a href="https://www.zotero.org/support/word_processor_plugin_usage#document_preferences">Zotero document preferences</a>.</li>
                <li>Zotero references from documents last used with Zotero 3.x or 4.x can only be extracted if the "Store references in document" option was checked.
                  This option no longer exists in Zotero 5.x, which always embeds item metadata.</li>
                <li>Zotero offers easy import via its File menu, with an "Import..." option for downloaded CSL JSON, BibTeX, or RIS files, and an "Import from Clipboard" option if you use the "Copy to Clipboard" button of this tool.</li>
              </ul>
            </div>
            <div role="tabpanel" class="tab-pane" id="troubleshooting">
              If Reference Extractor doesn't work as expected, you can try the following:
              <ul>
                <li>Make sure your Word document has been saved in the ".docx" format</li>
                <li>Make sure your Word document contains 'active' Zotero or Mendeley citations.
                  Active citations should have a grey background, and pressing Alt+F9 in Word should toggle them to show or hide their field codes.
                  Inactive citations have a white background and look like regular text.
                <li>Try a different browser, like Firefox or Google Chrome</li>
                <li>If you have JavaScript disabled (e.g. by using a browser extension like NoScript), enable JavaScript for this webpage</li>
              </ul>
              If you're still stuck, don't hesitate to reach out for assistance.
            </div>
            <div role="tabpanel" class="tab-pane" id="testimonials">
              Reference Extractor is recommended by the following institutions:
              <ul>
                <li><a href="https://update.lib.berkeley.edu/2018/02/07/extracting-references-from-an-already-created-bibliography/">Berkeley Library</a></li>
                <li><a href="https://twitter.com/BUNanterre/status/953527431838752769">Biblioth√®que Universitaire Paris Nanterre</a></li>
                <li><a href="https://libanswers.caltech.edu/faq/204009">Caltech Library</a></li>
                <li><a href="https://libguides.libraries.wsu.edu/c.php?g=768677&p=5514182">Washington State University Libraries</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="panel panel-success">
          <div class="panel-heading">Support</div>
          <div class="panel-body bg-warning">
            <p>Did you find this free tool useful?
              Please support my open-source work, e.g. with a <a href="https://www.patreon.com/rintzezelle">monthly donation via Patreon</a>, by starring my <a href="https://github.com/rmzelle/ref-extractor/">ref-extractor GitHub repository</a>, or with a small one-time donation:
              <br><br>
              <a href='https://ko-fi.com/rintzezelle' target='_blank'><img src='https://www.ko-fi.com/img/githubbutton_sm.svg' alt='Buy Me a Coffee at ko-fi.com'/></a> (PayPal and credit cards)
              <br><br>
              To report issues or feature requests, <a href="https://github.com/rmzelle/ref-extractor/issues">file a GitHub issue</a> or <a href="https://twitter.com/rintzezelle">send me a tweet</a>.
              <br><br>
              This tool uses the <a href="https://citation.js.org/">Citation.js</a> JavaScript library for reference format conversion.</p>
          </div>
        </div>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-sm-offset-1 col-sm-11">
        <form class="form-horizontal" autocomplete="off">
          <h3 class="col-sm-offset-3">Steps</h3>
          <div class="form-group">
            <label for="add_citation_counts_toggle" class="col-sm-3 control-label">[1] Settings</label>
            <div class="checkbox col-sm-6">
              <label><input id="add_citation_counts_toggle" type="checkbox" aria-describedby="helpBlock">Store cite counts in "note" field</label>
              <p id="helpBlock" class="help-block">The cite count is the number of times each item is cited in the document. The "note" field appears as "Extra" in Zotero.</p>
            </div>
          </div>
          <div class="form-group">
            <label for="file_upload" class="col-sm-3 control-label">[2] Select your .docx Word file</label>
            <input id="file_upload" type="file" class="adjust-top">
          </div>
          <h3 class="col-sm-offset-3">Results</h3>
          <div class="form-group has-success">
            <label class="col-sm-3 control-label">No. of extracted references</label>
            <div id="extract_count" class="form-control-static">___</div>
          </div>
          <div class="form-group has-success">
            <label class="col-sm-3 control-label">CSL style selected in document</label>
            <div id="selected_style" class="form-control-static">___</div>
          </div>
          <div class="form-group has-success">
            <label for="output_format" class="col-sm-3 control-label">Desired output format</label>
            <select id="output_format" class="adjust-top">
              <option value="data" selected>CSL JSON</option>
              <option value="bibtex">BibTeX</option>
              <option value="ris">RIS</option>
              <option value="bibliography">Formatted citations (APA style)</option>
            </select>
          </div>
          <div class="form-group has-success">
            <label for="textArea" class="col-sm-3 control-label">Extracted references</label>
            <div class="col-sm-7" style="padding-left:0px;">
              <button id="download" type="button" class="btn btn-success" disabled>Download</button>
              <button id="copy_to_clipboard" data-clipboard-text="" type="button" class="btn btn-success" disabled>Copy to clipboard</button>
              <div class="btn-group">
                <button id="zotero_item_selection_button" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                  Select cited items in Zotero <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" id="zotero_item_selection_link_list"></ul>
              </div>
              <textarea id="textArea" class="form-control" rows="15" readonly style="margin-top: 10px;"></textarea>
            </div>
          </div>
        </form>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-sm-offset-1 col-sm-11">
        <div id="footer"><small>Created by <a href="http://rintze.zelle.me/">Rintze M. Zelle</a>. MIT-licensed. Powered by GitHub Pages. <a href="https://github.com/rmzelle/ref-extractor">Code</a> on GitHub.</small>
        </div>
      </div>
    </div>
  </div>
  <script src="libraries/ref-extractor.js"></script>
</body>

</html>
