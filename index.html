<!DOCTYPE html>
<html lang="en">

<head>
  <title>Reference Extractor</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap-theme.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.0/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/citation-js@0.4.0-10"></script>
  <style>
    .adjust-top {
      padding-top: 7px;
    }

    .form-group.has-success {
      margin-bottom: 5px;
    }
  </style>
</head>

<body>
  <div class="container-fluid">
    <div class="navbar navbar-default" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <div class="navbar-brand">Reference Extractor</div>
          <div class="navbar-text">Extract Zotero and Mendeley references from Microsoft Word files</div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-offset-1 col-sm-7">
        <p><strong>Reference Extractor</strong> is a free open-source webtool to extract <a href="https://www.zotero.org/">Zotero</a> and <a href="https://www.mendeley.com/">Mendeley</a> references from Microsoft Word <strong>.docx</strong> documents.
          It has two main features:
          <ul>
            <li>Extracted references can be saved in CSL JSON, BibTeX, or RIS format for import into a reference manager like Zotero or Mendeley, or they can be rendered as formatted citations in APA style.</li>
            <li>If you have access to the Zotero libraries from which the items were cited, this tool allows you to select the original items in Zotero.</li>
          </ul>
          Your privacy is important to me. I built this tool to operate entirely client-side, and your documents never leave your computer. No snooping, no tracking, no ads.
        </p>
        <h5>Tips on use</h5>
        <ul>
          <li>Zotero references are only detected if they have been stored as "Fields", not "Bookmarks".
            This can be changed for existing documents through the <a href="https://www.zotero.org/support/word_processor_plugin_usage#document_preferences">Zotero document preferences</a>.</li>
          <li>Zotero references from documents last used with Zotero 3.x or 4.x can only be extracted if the "Store references in document" option was checked.
            This option no longer exists in Zotero 5.x, which always embeds item metadata.</li>
          <li>If you want to import extracted references, use the CSL JSON output format for best results.
            This is the format used by Zotero and Mendeley to embed item metadata in Word documents.
            All other output formats involve a format conversion.
            Note that while Zotero can import CSL JSON files, support for this format is otherwise limited.
          <li>Zotero offers easy import via its File menu, with an "Import..." option for downloaded CSL JSON, BibTeX, or RIS files, and an "Import from Clipboard" option if you use the "Copy to Clipboard" button of this tool.</li>
        </ul>
      </div>
      <div class="col-sm-3">
        <p class="bg-info">Did you find this free tool useful?
          Please support my open-source work, e.g. by <a href="https://www.paypal.me/RintzeZelle/2.50">buying me a coffee via PayPal</a> or with a <a href="https://www.patreon.com/rintzezelle">monthly donation via Patreon</a>.
          <br><br>
          For feedback, or to report any issues, please <a href="https://github.com/rmzelle/ref-extractor/issues">file an issue on GitHub</a> or ping me on <a href="https://twitter.com/rintzezelle">Twitter</a>.
          <br><br>
          This tool uses the open-source <a href="https://citation.js.org/">Citation.js</a> JavaScript library for reference format conversion.</p>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-sm-offset-1 col-sm-11">
        <form class="form-horizontal" autocomplete="off">
          <h3 class="col-sm-offset-3">Steps</h3>
          <div class="form-group">
            <label for="add_citation_counts_toggle" class="col-sm-3 control-label">[1] Settings</label>
            <div class="checkbox col-sm-6">
              <label><input id="add_citation_counts_toggle" type="checkbox" aria-describedby="helpBlock">Store cite counts in "note" field</label>
              <p id="helpBlock" class="help-block">The cite count is the number of times each item is cited in the document. The "note" field appears as "Extra" in Zotero.</p>
            </div>
          </div>
          <div class="form-group">
            <label for="file_upload" class="col-sm-3 control-label">[2] Select your .docx Word file</label>
            <input id="file_upload" type="file" class="adjust-top">
          </div>
          <h3 class="col-sm-offset-3">Results</h3>
          <div class="form-group has-success">
            <label class="col-sm-3 control-label">No. of extracted references</label>
            <div id="extract_count" class="form-control-static">___</div>
          </div>
          <div class="form-group has-success">
            <label class="col-sm-3 control-label">CSL style selected in document</label>
            <div id="selected_style" class="form-control-static">___</div>
          </div>
          <div class="form-group has-success">
            <label for="output_format" class="col-sm-3 control-label">Desired output format</label>
            <select id="output_format" class="adjust-top">
              <option value="data" selected>CSL JSON</option>
              <option value="bibtex">BibTeX</option>
              <option value="ris">RIS</option>
              <option value="bibliography">Formatted citations (APA style)</option>
            </select>
          </div>
          <div class="form-group has-success">
            <label for="textArea" class="col-sm-3 control-label">Extracted references</label>
            <div class="col-sm-7" style="padding-left:0px;">
              <button id="download" type="button" class="btn btn-success" disabled>Download</button>
              <button id="copy_to_clipboard" data-clipboard-text="" type="button" class="btn btn-success" disabled>Copy to clipboard</button>
              <div class="btn-group">
                <button id="zotero_item_selection_button" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" disabled>
                  Select cited items in Zotero <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" id="zotero_item_selection_link_list"/>
              </div>
              <textarea id="textArea" class="form-control" rows="15" readonly style="margin-top: 10px;"></textarea>
            </div>
          </div>
        </form>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-sm-offset-1 col-sm-11">
        <div id="footer"><small>Created by <a href="http://rintze.zelle.me/">Rintze M. Zelle</a>. MIT-licensed. Powered by GitHub Pages. <a href="https://github.com/rmzelle/ref-extractor">Code</a> on GitHub.</small>
        </div>
      </div>
    </div>
  </div>
  <script src="libraries/ref-extractor.js"></script>
</body>

</html>
